import{r as i,cb as g,cc as q,cd as v,k as E}from"./index-YFcBmQ5X.js";var S=()=>{const[n,a]=i.useState(""),[s,t]=i.useState(""),r=i.useCallback(g(o=>t(o),300),[]);return i.useEffect(()=>(r(n),()=>r.cancel()),[n,r]),{searchValue:n,onSearchValueChange:a,query:s||void 0}},I=({queryKey:n,queryFn:a,getOptions:s,defaultValue:t,defaultValueKey:r,pageSize:o=10,enabled:u=!0})=>{const{searchValue:d,onSearchValueChange:p,query:h}=S(),D=r||"id",{data:m}=q({queryKey:n,queryFn:async()=>a({[D]:t,limit:Array.isArray(t)?t.length:1}),enabled:!!t&&u}),{data:f,...y}=v({queryKey:[...n,h],queryFn:async({pageParam:e=0})=>await a({q:h,limit:o,offset:e}),initialPageParam:0,getNextPageParam:e=>e.count>e.offset+e.limit?e.offset+e.limit:void 0,placeholderData:E,enabled:u}),c=(f==null?void 0:f.pages.flatMap(e=>s(e)))??[],l=m?s(m):[],x=!y.isPending&&!c.length&&!d||!u;return t&&l.length&&!d&&l.forEach(e=>{c.find(b=>b.value===e.value)||c.unshift(e)}),{options:c,searchValue:d,onSearchValueChange:p,disabled:x,...y}};export{S as a,I as u};
